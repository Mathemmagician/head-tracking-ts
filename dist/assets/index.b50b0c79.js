import{S as P,G as O,T as R,M as H,a as W,A as N,P as U,b as D,W as $,F as z,V as E,C as G,d as B,c,f as d,e as V,g as f}from"./vendor.de406ae9.js";const Y=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const w of o.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&e(w)}).observe(document,{childList:!0,subtree:!0});function r(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(t){if(t.ep)return;t.ep=!0;const o=r(t);fetch(t.href,o)}};Y();const m=new P,X=new O,q=new R(8,6,16,100),Z=new H({color:16737095}),S=new W(q,Z);S.rotation.x=3.1415/2;m.add(S);const j=new N(16777215,.5);m.add(j);const F=new U(14737632);F.position.set(0,10,40);m.add(F);X.load("assets/collision-world.glb",n=>{let i=n.scene;i.scale.set(10,10,10),m.add(i)});const v=54,K=Math.PI/180,J=15,Q=new G,s=new D(v,window.innerWidth/window.innerHeight,.1,1e3),u=new $({canvas:document.querySelector("#bg")});u.setPixelRatio(window.devicePixelRatio);u.setSize(window.innerWidth,window.innerHeight);s.position.set(0,50,50);const x=new z(s,u.domElement);x.dragToLook=!0;window.addEventListener("resize",ee);function ee(){s.aspect=window.innerWidth/window.innerHeight,s.updateProjectionMatrix(),u.setSize(window.innerWidth,window.innerHeight)}function te(n,i){const e=J/i/2/Math.tan(v/2*K),t=(n.x-.5)*100,o=-(n.y-.5)*100;return new E(t,o,e)}function ne(n,i){const r=Math.min(.05,Q.getDelta())*100;x.update(r);const e=te(n,i);s.translateX(e.x),s.translateY(e.y),s.translateZ(e.z),u.render(m,s),s.translateX(-e.x),s.translateY(-e.y),s.translateZ(-e.z)}oe([{client:"Chrome"}]);function oe(n){const r=new B().parse(navigator.userAgent);if(r.client===null||r.os===null){alert("Could not detect browser and/or os, continue at your own risk.");return}let e=!1;for(const t of n)if(!(t.client!==void 0&&!new RegExp(`^${t.client}$`).test(r.client.name))&&!(t.os!==void 0&&!new RegExp(`^${t.os}$`).test(r.os.name))){e=!0;break}e||alert(`This demo, running on ${r.client.name}/${r.os.name}, is not well supported at this time, continue at your own risk.`)}const h={silhouette:[10,338,297,332,284,251,389,356,454,323,361,288,397,365,379,378,400,377,152,148,176,149,150,136,172,58,132,93,234,127,162,21,54,103,67,109],lipsUpperOuter:[61,185,40,39,37,0,267,269,270,409,291],lipsLowerOuter:[146,91,181,84,17,314,405,321,375,291],lipsUpperInner:[78,191,80,81,82,13,312,311,310,415,308],lipsLowerInner:[78,95,88,178,87,14,317,402,318,324,308],rightEyeUpper0:[246,161,160,159,158,157,173],rightEyeLower0:[33,7,163,144,145,153,154,155,133],rightEyeUpper1:[247,30,29,27,28,56,190],rightEyeLower1:[130,25,110,24,23,22,26,112,243],rightEyeUpper2:[113,225,224,223,222,221,189],rightEyeLower2:[226,31,228,229,230,231,232,233,244],rightEyeLower3:[143,111,117,118,119,120,121,128,245],rightEyebrowUpper:[156,70,63,105,66,107,55,193],rightEyebrowLower:[35,124,46,53,52,65],rightEyeIris:[473,474,475,476,477],leftEyeUpper0:[466,388,387,386,385,384,398],leftEyeLower0:[263,249,390,373,374,380,381,382,362],leftEyeUpper1:[467,260,259,257,258,286,414],leftEyeLower1:[359,255,339,254,253,252,256,341,463],leftEyeUpper2:[342,445,444,443,442,441,413],leftEyeLower2:[446,261,448,449,450,451,452,453,464],leftEyeLower3:[372,340,346,347,348,349,350,357,465],leftEyebrowUpper:[383,300,293,334,296,336,285,417],leftEyebrowLower:[265,353,276,283,282,295],leftEyeIris:[468,469,470,471,472],midwayBetweenEyes:[168],noseTip:[1],noseBottom:[2],noseRightCorner:[98],noseLeftCorner:[327],rightCheek:[205],leftCheek:[425]},ie={locateFile:n=>`node_modules/@mediapipe/face_mesh/${n}`},C=1280,T=720,L=document.getElementsByClassName("input_video")[0],p=document.getElementsByClassName("output_canvas")[0],re=document.getElementsByClassName("control-panel")[0],a=p.getContext("2d"),M={selfieMode:!0,enableFaceGeometry:!1,maxNumFaces:1,refineLandmarks:!1,minDetectionConfidence:.5,minTrackingConfidence:.5,intensity:1,color:16777215},_=new c.FPS,k=document.querySelector(".loading");k.ontransitionend=()=>{k.style.display="none"};let b=1;function se(n){document.body.classList.add("loaded"),_.tick(),a.save(),a.clearRect(0,0,p.width,p.height),a.drawImage(n.image,0,0,p.width,p.height);const i=h.rightEyeUpper0.concat(h.rightEyeLower0),r=h.leftEyeUpper0.concat(h.leftEyeLower0);if(n.multiFaceLandmarks.length>0){const e=n.multiFaceLandmarks[0];b===0&&console.log(d.FACEMESH_FACE_OVAL),f.drawLandmarks(a,i.map(l=>e[l]),{color:"red",radius:5}),f.drawLandmarks(a,r.map(l=>e[l]),{color:"green",radius:5}),b+=.1,f.drawConnectors(a,e,d.FACEMESH_TESSELATION,{color:"#C0C0C070",lineWidth:1}),f.drawConnectors(a,e,d.FACEMESH_FACE_OVAL,{color:"#E0E0E0"}),f.drawConnectors(a,e,d.FACEMESH_LIPS,{color:"#E0E0E0"}),M.refineLandmarks&&(f.drawConnectors(a,e,d.FACEMESH_RIGHT_IRIS,{color:"#FF3030"}),f.drawConnectors(a,e,d.FACEMESH_LEFT_IRIS,{color:"#30FF30"}));const t=e[226],o=e[446],w=Math.abs(t.x-o.x)*C,A=Math.abs(t.y-o.y)*T,I=Math.hypot(w,A);let y=new E(0,0,0);for(const l of e)y.add(new E(l.x,l.y,l.z));y.divideScalar(e.length),ne(y,I/C)}a.restore()}const g=new d.FaceMesh(ie);g.setOptions(M);g.onResults(se);const ae=new V.Camera(L,{onFrame:async()=>{await g.send({image:L}).catch(n=>alert(n))},width:C,height:T});ae.start();new c.ControlPanel(re,M).add([new c.StaticText({title:"MediaPipe Face Mesh"}),_,new c.Toggle({title:"Selfie Mode",field:"selfieMode"}),new c.Slider({title:"Max Number of Faces",field:"maxNumFaces",range:[1,4],step:1}),new c.Toggle({title:"Refine Landmarks",field:"refineLandmarks"}),new c.Slider({title:"Min Detection Confidence",field:"minDetectionConfidence",range:[0,1],step:.01}),new c.Slider({title:"Min Tracking Confidence",field:"minTrackingConfidence",range:[0,1],step:.01}),new c.Slider({title:"light intensity",field:"intensity",range:[-1,6],step:.01}),new c.Slider({title:"light color",field:"color",range:[0,16777215],step:1})]).on(n=>{const i=n;L.classList.toggle("selfie",i.selfieMode),g.setOptions(i)});
